language:
- java

jdk:
- openjdk8
- openjdk11
- openjdk13

services:
  - xvfb

before_script:
# setup a display on linux ( the sleep gives xvfb some time to start )
- export DISPLAY=:99.0 ; sh -e /etc/init.d/xvfb start ; sleep 3
# setup code coverage reporting on code climate
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- ./cc-test-reporter before-build

script:
- mvn --batch-mode --settings .travis.settings.xml clean test jacoco:report

after_success:
- mvn --batch-mode --settings .travis.settings.xml site site-deploy
- bash <(curl -s https://codecov.io/bash)

after_script:
- JACOCO_SOURCE_PATH=src/main/java ./cc-test-reporter format-coverage target/site/jacoco/jacoco.xml --input-type jacoco
- ./cc-test-reporter upload-coverage

cache:
  directories:
  - $HOME/.m2

env:
  global:
  - CC_TEST_REPORTER_ID=40eb152aa3b251a319b52740118eeb61e6be95602a0268143736edb26c6fe5ce
