language:
- java

jdk:
- openjdk8
- openjdk11
- openjdk13

services:
  - xvfb

before_script:
# setup a display on linux ( the sleep gives xvfb some time to start )
- export DISPLAY=:99.0 ; sh -e /etc/init.d/xvfb start ; sleep 3
# setup code coverage reporting on code climate
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- ./cc-test-reporter before-build

script:
- mvn --batch-mode --settings .travis.settings.xml clean test jacoco:report

after_success:
- mvn --batch-mode --settings .travis.settings.xml site site-deploy
- bash <(curl -s https://codecov.io/bash)

after_script:
- JACOCO_SOURCE_PATH=src/main/java ./cc-test-reporter format-coverage target/site/jacoco/jacoco.xml --input-type jacoco
- ./cc-test-reporter upload-coverage

cache:
  directories:
  - $HOME/.m2

env:
  global:
  - CC_TEST_REPORTER_ID=74ea770a7cc8f327d1eeb5b1d8e3589909f123fb8b59e9195bc45e3786f2c4d2
  - secure: CCgzgYAJ24Q22j7N0817My5Jsq9/SAY2gKIYBBvnQ0v1s70OYTtao45H60wdRFCSBG8Iv0V9Nm6qa9IRdGKRB5jTTHN5sqM/to1EnmHzylI5V20P5IK6agXCWAPhIm+fTL7MffHy7hVaz3GTDBVyzi2JSoM/wfA/JlF7RubHY79SMA8sviJNlTq9lYNBD4/1MHKJoqMR3DsDNJ8oocLlLEfpRUhrrqJT3kgkt+3FXaCEL1QjNa+MXrEYaM1DxiWgbpurVrVro963hPzCS5Gin61NAiqMCGzHmyQbAHAD27uW22W/e8tCvRJjP2MI4j/ammuLtChaBCc+mmcs/nd8zNOL8U9SozB3s6do13XsceaAc5DsbobSMTLaV7Bk3KmkzEp55hWMcYUMbWuOq8Ap762o9r9iu4rEPR/I/6v2DiASQK5ry5ePvzLIpnQOoa3xJZ44H28Rrc7sA8QTKfHmFVfvIv9qs/hNd+6ucFdsrJt5Ly8RYZ2tVgrXWn/vn0CLZAEMe9pnbdXDnqa2zE3P4zOndhAsKfAVnimLSZduJLx1rv9BHLkdRtH2dAj9uxyPhETfzDbvezqvtCPIKZfdNh7ZSpKuIadmNIEWUat3XqhvuXdZzrCCA/di6T1hfsLFp34APKrMbS0Jh0ODxqgao9BdkJu77AgyGg0NWMTd2B8=
